<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>React笔记 | 野菜收留所</title><meta name="author" content="菜"><meta name="copyright" content="菜"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="官网：https:&#x2F;&#x2F;react.docschina.org&#x2F; 一、React简介1. React入门概述：React用于构建用户界面的轻量级的JS库，只关注 MVC 中的V（视图）。 特点：  单向数据流 组件化 虚拟 DOM  2. React项目创建2.1 官方脚手架npx create-react-app 项目名 npm6+ npm init react-app 项目名 2.2 viten">
<meta property="og:type" content="article">
<meta property="og:title" content="React笔记">
<meta property="og:url" content="https://793335974.github.io/79333/2021/08/10/React%E7%AC%94%E8%AE%B0/index.html">
<meta property="og:site_name" content="野菜收留所">
<meta property="og:description" content="官网：https:&#x2F;&#x2F;react.docschina.org&#x2F; 一、React简介1. React入门概述：React用于构建用户界面的轻量级的JS库，只关注 MVC 中的V（视图）。 特点：  单向数据流 组件化 虚拟 DOM  2. React项目创建2.1 官方脚手架npx create-react-app 项目名 npm6+ npm init react-app 项目名 2.2 viten">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://api.gumengya.com/Api/FjImg?format=image&_t=18">
<meta property="article:published_time" content="2021-08-10T08:00:00.000Z">
<meta property="article:modified_time" content="2024-05-24T07:27:17.908Z">
<meta property="article:author" content="菜">
<meta property="article:tag" content="编程">
<meta property="article:tag" content="前端">
<meta property="article:tag" content="React">
<meta property="article:tag" content="框架">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://api.gumengya.com/Api/FjImg?format=image&_t=18"><link rel="shortcut icon" href="/79333/img/favicon.png"><link rel="canonical" href="https://793335974.github.io/79333/2021/08/10/React%E7%AC%94%E8%AE%B0/index.html"><link rel="preconnect"/><meta/><link rel="stylesheet" href="/79333/css/index.css"><link rel="stylesheet" href="/79333/pluginsSrc/@fortawesome/fontawesome-free/css/all.min.css?v=6.5.1"><link rel="stylesheet" href="/79333/pluginsSrc/@fancyapps/ui/dist/fancybox/fancybox.css?v=5.0.33" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/79333/',
  algolia: undefined,
  localSearch: {"path":"/79333/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: '/79333/pluginsSrc/@egjs/infinitegrid/dist/infinitegrid.min.js?v=4.11.1',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'React笔记',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-05-24 15:27:17'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/79333/css/video.css"><script src="/79333/js/video.js"></script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/79333/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/79333/archives/"><div class="headline">文章</div><div class="length-num">21</div></a><a href="/79333/tags/"><div class="headline">标签</div><div class="length-num">25</div></a><a href="/79333/categories/"><div class="headline">分类</div><div class="length-num">14</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/79333/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/79333/archives/"><i class="fa-fw fas fa-archive"></i><span> 文章</span></a></div><div class="menus_item"><a class="site-page" href="/79333/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/79333/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 列表</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/79333/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/79333/movies/"><i class="fa-fw fas fa-video"></i><span> 视频</span></a></li><li><a class="site-page child" href="/79333/images/"><i class="fa-fw fas fa-images"></i><span> 图片</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/79333/link/"><i class="fa-fw fas fa-link"></i><span> 链接</span></a></div><div class="menus_item"><a class="site-page" href="/79333/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://api.gumengya.com/Api/FjImg?format=image&amp;_t=18')"><nav id="nav"><span id="blog-info"><a href="/79333/" title="野菜收留所"><span class="site-name">野菜收留所</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/79333/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/79333/archives/"><i class="fa-fw fas fa-archive"></i><span> 文章</span></a></div><div class="menus_item"><a class="site-page" href="/79333/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/79333/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 列表</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/79333/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/79333/movies/"><i class="fa-fw fas fa-video"></i><span> 视频</span></a></li><li><a class="site-page child" href="/79333/images/"><i class="fa-fw fas fa-images"></i><span> 图片</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/79333/link/"><i class="fa-fw fas fa-link"></i><span> 链接</span></a></div><div class="menus_item"><a class="site-page" href="/79333/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">React笔记</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-08-10T08:00:00.000Z" title="发表于 2021-08-10 16:00:00">2021-08-10</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-05-24T07:27:17.908Z" title="更新于 2024-05-24 15:27:17">2024-05-24</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/79333/categories/%E5%89%8D%E7%AB%AF/">前端</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">8.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>37分钟</span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>官网：<a target="_blank" rel="noopener" href="https://react.docschina.org/">https://react.docschina.org/</a></p>
<h2 id="一、React简介"><a href="#一、React简介" class="headerlink" title="一、React简介"></a>一、React简介</h2><h3 id="1-React入门"><a href="#1-React入门" class="headerlink" title="1. React入门"></a>1. React入门</h3><p>概述：React用于构建用户界面的轻量级的JS库，只关注 MVC 中的V（视图）。</p>
<p>特点：</p>
<ul>
<li>单向数据流</li>
<li>组件化</li>
<li>虚拟 DOM</li>
</ul>
<h3 id="2-React项目创建"><a href="#2-React项目创建" class="headerlink" title="2. React项目创建"></a>2. React项目创建</h3><h4 id="2-1-官方脚手架"><a href="#2-1-官方脚手架" class="headerlink" title="2.1 官方脚手架"></a>2.1 官方脚手架</h4><p><code>npx create-react-app 项目名</code></p>
<p>npm6+</p>
<p><code>npm init react-app 项目名</code></p>
<h4 id="2-2-vite"><a href="#2-2-vite" class="headerlink" title="2.2 vite"></a>2.2 vite</h4><p><code>npm create vite@last 项目名 -- --template react</code></p>
<h4 id="2-3-redux"><a href="#2-3-redux" class="headerlink" title="2.3 redux"></a>2.3 redux</h4><p>新项目：</p>
<p><code>npx create-react-app 项目名 --template redux</code></p>
<p><code>npx create-react-app 项目名 --template redux-typescript</code></p>
<p>老项目：</p>
<p><code>npm i redux react-redux</code></p>
<h4 id="2-4-redux-thunk"><a href="#2-4-redux-thunk" class="headerlink" title="2.4 redux-thunk"></a>2.4 redux-thunk</h4><p><code>npm i redux-thunk</code></p>
<h4 id="2-5-index-html"><a href="#2-5-index-html" class="headerlink" title="2.5 index.html"></a>2.5 index.html</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--%PUBLIC_URL%表示public文件夹的路径--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;icon&quot;</span> <span class="attr">href</span>=<span class="string">&quot;%PUBLIC_URL%/favicon.ico&quot;</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--用于开启理想视口，用于移动端页面的适配--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1&quot;</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--用于配置浏览器地址栏的颜色（仅支持安卓手机浏览器）--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;theme-color&quot;</span> <span class="attr">content</span>=<span class="string">&quot;#000000&quot;</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--描述网页信息的--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span></span></span><br><span class="line"><span class="tag">      <span class="attr">name</span>=<span class="string">&quot;description&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">content</span>=<span class="string">&quot;Web site created using create-react-app&quot;</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--用于指定网页添加到手机主屏幕后的图标（仅仅支持ios）--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;apple-touch-icon&quot;</span> <span class="attr">href</span>=<span class="string">&quot;%PUBLIC_URL%/logo192.png&quot;</span> /&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment">&lt;!--应用加壳时候的配置文件 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;manifest&quot;</span> <span class="attr">href</span>=<span class="string">&quot;%PUBLIC_URL%/manifest.json&quot;</span> /&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>React App<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 浏览器不支持JS的运行的时候展现 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">noscript</span>&gt;</span>You need to enable JavaScript to run this app.<span class="tag">&lt;/<span class="name">noscript</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;root&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="2-6-路由"><a href="#2-6-路由" class="headerlink" title="2.6 路由"></a>2.6 路由</h4><p><code>npm install react-router-dom</code></p>
<h3 id="3-JSX语法"><a href="#3-JSX语法" class="headerlink" title="3. JSX语法"></a>3. JSX语法</h3><ul>
<li>可以直接将标签赋值给变量</li>
<li>如果要在标签之间插入JS变量或者JS表达式，必须使用{}</li>
<li>需要替换部分的关键字，如标签上的 class 写为 className , for 写为 htmlFor</li>
<li>事件绑定要使用小驼峰的写法，如onClick</li>
<li>所有的标签必须闭合，即 <img>必须写为<img/></li>
<li>标签中的注释需要写在 {} 中</li>
<li>当变量是 Number,String 时可以直接显示</li>
<li>当变量是Null,Undefined,Boolean,就会显示空</li>
<li>如果是Object则不能直接渲染</li>
<li>如果是数组，那么会直接展开数组</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 插入变量</span></span><br><span class="line"><span class="keyword">const</span> title = <span class="string">&#x27;您好&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> head = <span class="language-xml"><span class="tag">&lt;<span class="name">header</span>&gt;</span>&#123;title&#125;<span class="tag">&lt;/<span class="name">header</span>&gt;</span></span>;</span><br><span class="line">&#123;head&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用函数</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">sum</span> = (<span class="params"></span>) =&gt; <span class="number">3</span>;</span><br><span class="line">&#123;<span class="title function_">sum</span>()&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 属性绑定</span></span><br><span class="line"><span class="keyword">const</span> title = <span class="string">&#x27;您好&#x27;</span>;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">title</span>=<span class="string">&#123;title&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//  style 绑定</span></span><br><span class="line"><span class="keyword">const</span> style = &#123;</span><br><span class="line">    <span class="attr">color</span>: <span class="string">&#x27;red&#x27;</span>,</span><br><span class="line">    <span class="attr">backgroundColor</span>: <span class="string">&#x27;yellow&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">style</span>=<span class="string">&#123;style&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//  class 绑定</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">p</span> <span class="attr">className</span>=<span class="string">&#123;n</span> ? &#x27;<span class="attr">on</span>&#x27; <span class="attr">:</span> &#x27;&#x27;&#125;&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">p</span> <span class="attr">className</span>=<span class="string">&#123;[</span>&#x27;<span class="attr">class1</span>&#x27;, &#x27;<span class="attr">class2</span>&#x27;, (<span class="attr">n</span> ? &#x27;<span class="attr">on</span>&#x27; <span class="attr">:</span> &#x27;&#x27;)]<span class="attr">.join</span>(&#x27; &#x27;)&#125;&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 条件渲染</span></span><br><span class="line"><span class="comment">// if</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">dom</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (flag) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>flag 为 true<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>flag 为 false<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 三元</span></span><br><span class="line">flag ? <span class="language-xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>flag 为 true<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span> : <span class="language-xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>flag 为 false<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// &amp;&amp;</span></span><br><span class="line">    flag &amp;&amp; <span class="language-xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>flag 为 true<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 列表渲染</span></span><br><span class="line"><span class="keyword">const</span> data = [</span><br><span class="line"><span class="string">&#x27;aa&#x27;</span>, <span class="string">&#x27;bb&#x27;</span>, <span class="string">&#x27;cc&#x27;</span>, <span class="string">&#x27;dd&#x27;</span></span><br><span class="line">]</span><br><span class="line"><span class="keyword">const</span> newData = data.<span class="title function_">map</span>(<span class="params">(item, index) =&gt; &lt;li key=&#123;index&#125;&gt;&#123;item&#125;&lt;/li&gt;</span>)</span><br><span class="line"></span><br><span class="line">&#123;newData&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-跨域"><a href="#4-跨域" class="headerlink" title="4. 跨域"></a>4. 跨域</h3><p>解决：</p>
<h4 id="方法一：proxy"><a href="#方法一：proxy" class="headerlink" title="方法一：proxy"></a>方法一：proxy</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在package.json中追加如下配置</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;proxy&quot;</span>:<span class="string">&quot;请求的地址&quot;</span>      <span class="string">&quot;proxy&quot;</span>:<span class="string">&quot;http://localhost:5000&quot;</span>  </span><br></pre></td></tr></table></figure>

<p>说明：</p>
<ol>
<li>优点：配置简单，前端请求资源时可以不加任何前缀。</li>
<li>缺点：不能配置多个代理。</li>
<li>工作方式：上述方式配置代理，当请求了3000不存在的资源时，那么该请求会转发给5000 （优先匹配前端资源）</li>
</ol>
<h4 id="方法二：创建代理配置文件"><a href="#方法二：创建代理配置文件" class="headerlink" title="方法二：创建代理配置文件"></a>方法二：创建代理配置文件</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在src下创建配置文件：src/setupProxy.<span class="property">js</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> proxy = <span class="built_in">require</span>(<span class="string">&#x27;http-proxy-middleware&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="keyword">function</span>(<span class="params">app</span>) &#123;</span><br><span class="line">  app.<span class="title function_">use</span>(</span><br><span class="line">    <span class="title function_">proxy</span>(<span class="string">&#x27;/api1&#x27;</span>, &#123;  <span class="comment">//api1是需要转发的请求(所有带有/api1前缀的请求都会转发给5000)</span></span><br><span class="line">      <span class="attr">target</span>: <span class="string">&#x27;http://localhost:5000&#x27;</span>, <span class="comment">//配置转发目标地址(能返回数据的服务器地址)</span></span><br><span class="line">      <span class="attr">changeOrigin</span>: <span class="literal">true</span>, <span class="comment">//控制服务器接收到的请求头中host字段的值</span></span><br><span class="line">      <span class="comment">/*</span></span><br><span class="line"><span class="comment">      	changeOrigin设置为true时，服务器收到的请求头中的host为：localhost:5000</span></span><br><span class="line"><span class="comment">      	changeOrigin设置为false时，服务器收到的请求头中的host为：localhost:3000</span></span><br><span class="line"><span class="comment">      	changeOrigin默认值为false，但我们一般将changeOrigin值设为true</span></span><br><span class="line"><span class="comment">      */</span></span><br><span class="line">      <span class="attr">pathRewrite</span>: &#123;<span class="string">&#x27;^/api1&#x27;</span>: <span class="string">&#x27;&#x27;</span>&#125; <span class="comment">//去除请求前缀，保证交给后台服务器的是正常请求地址(必须配置)</span></span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="title function_">proxy</span>(<span class="string">&#x27;/api2&#x27;</span>, &#123; </span><br><span class="line">      <span class="attr">target</span>: <span class="string">&#x27;http://localhost:5001&#x27;</span>,</span><br><span class="line">      <span class="attr">changeOrigin</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">pathRewrite</span>: &#123;<span class="string">&#x27;^/api2&#x27;</span>: <span class="string">&#x27;&#x27;</span>&#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>说明：</p>
<ol>
<li>优点：可以配置多个代理，可以灵活的控制请求是否走代理。</li>
<li>缺点：配置繁琐，前端请求资源时必须加前缀。</li>
</ol>
<h3 id="5-React-和-Vue的区别"><a href="#5-React-和-Vue的区别" class="headerlink" title="5. React 和 Vue的区别"></a>5. React 和 Vue的区别</h3><p>相同点：</p>
<ul>
<li>数据驱动视图</li>
<li>组件化思想</li>
<li>都是用虚拟Dom</li>
</ul>
<p>不同点：</p>
<ul>
<li>核心思想不通：<ul>
<li>Vue为渐进式框架，门槛较低，进行数据劫持或者代理</li>
<li>React函数式编程，数据不可变以及单向数据流</li>
</ul>
</li>
<li>组件写法差异：<ul>
<li>Vue单文件组建格式，即html,css,js写在同一个文件</li>
<li>React为html和css都写进js中</li>
</ul>
</li>
<li>diff算法不同：<ul>
<li>react 首先对新集合进行遍历，通过唯一key值来判断新旧集合中是否存在相同的节点，如果没有的话就创建，如果有的话就会将节点在新集合中的位置和老集合中的位置进行比较，如果不同，则进行移动操作，否则就不操作。如果在遍历的过程中，发现在新集合中没有，就会进行删除操作。</li>
<li>Vue新旧集合各有头尾的变量，他们的2各变量相互比较，一共有四种比较方式，如果四种都没匹配，则会匹配key值，借助key值找到可复用的节点，在进行相关操作。</li>
</ul>
</li>
<li>响应式原理不同：</li>
<li><ul>
<li>Vue依赖收集，自动依赖，数据可变。递归监听data中的所有属性，直接修改，当数据改变时，自动找到引用组件重新渲染。</li>
<li>React基于状态手动优化，数据不可变，需要setState驱动新的state替换老的state。当数据改变时，以组件为根目录，默认全部重新渲染，所以React中会需要shouldComponentUpdate这个生命周期函数来进行控制。</li>
</ul>
</li>
</ul>
<h2 id="二、React核心"><a href="#二、React核心" class="headerlink" title="二、React核心"></a>二、React核心</h2><h3 id="1-组件化"><a href="#1-组件化" class="headerlink" title="1. 组件化"></a>1. 组件化</h3><p>概述：组件允许将 UI 部分拆违可独立使用的代码片段</p>
<p>组件划分：</p>
<ul>
<li><code>class</code> 组件：使用class 去创建组件，可以包含逻辑和状态</li>
<li>函数组件：以函数为组件，目前可以为函数组件添加状态</li>
</ul>
<h4 id="1-1-class-组件"><a href="#1-1-class-组件" class="headerlink" title="1.1 class 组件"></a>1.1 class 组件</h4><p>概述：每一个组件一个文件。该文件后缀可以是 js 也可以是 jsx</p>
<h5 id="执行过程"><a href="#执行过程" class="headerlink" title="执行过程"></a>执行过程</h5><ul>
<li>React解析组件标签，找到相应的组件 </li>
<li>发现组建时类定义的，随后 <code>new </code>出来的类的实例，并通过该实例调用到原型上的 <code>render </code>方法</li>
<li>将 <code>render</code> 返回的虚拟 DOM 转化为真实的 DOM ，随后呈现在页面中</li>
</ul>
<h5 id="1-1-1-语法"><a href="#1-1-1-语法" class="headerlink" title="1.1.1 语法"></a>1.1.1 语法</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">写法一：在constructor 中添加的状态</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">	<span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">		<span class="variable language_">super</span>(props) <span class="comment">// 继承必须在这里调用 super</span></span><br><span class="line">		<span class="variable language_">this</span>.<span class="property">state</span> = &#123;&#125; <span class="comment">// class 组件的data，响应式数据</span></span><br><span class="line">	&#125;</span><br><span class="line"><span class="title function_">render</span>(<span class="params"></span>) &#123; <span class="comment">// 每一个class 组件必须设置 render，然后在 render 中返回dom 节点</span></span><br><span class="line">	<span class="keyword">return</span> &#123;</span><br><span class="line">		<span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    		<span class="tag">&lt;<span class="name">h1</span>&gt;</span>React<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"> 		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 写法2：ES7 class 实验性质写法</span></span><br><span class="line">  <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">    state = &#123;&#125;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">      <span class="variable language_">super</span>(props); <span class="comment">// 继承必须在这里调用 super</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">render</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure>

<h5 id="1-1-2-修改数据"><a href="#1-1-2-修改数据" class="headerlink" title="1.1.2 修改数据"></a>1.1.2 修改数据</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 只能调用 setState 方法去修改 state。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 语法</span></span><br><span class="line"><span class="title function_">setState</span>(updater[ ,callback])</span><br><span class="line">    * updater： 可以接受对象类型，也可以接受函数类型；</span><br><span class="line">        * callback：可选参数，在 state 修改之后执行的回调函数；</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">            <span class="attr">count</span>: <span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">                      <span class="comment">// 基于之前的值来修改</span></span><br><span class="line">                      <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">                      <span class="attr">count</span>: <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">count</span> + <span class="number">1</span></span><br><span class="line">                      &#125;);</span><br><span class="line"><span class="comment">// 使用函数</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="title function_">setState</span>(<span class="function">(<span class="params">preState, props</span>) =&gt;</span> (&#123;</span><br><span class="line">    <span class="attr">count</span>: preState.<span class="property">count</span> + <span class="number">1</span></span><br><span class="line">&#125;))</span><br></pre></td></tr></table></figure>

<p>局部数据修改</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// const newUser = Object.assign(this.state.user, &#123; name: &#x27;lily&#x27; &#125;)</span></span><br><span class="line">    <span class="keyword">const</span> newUser = &#123;</span><br><span class="line">      ...<span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">user</span>,</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;lily&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">      <span class="attr">user</span>: newUser</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure>

<p>数组数据修改：</p>
<p>React 执行 diff 时是比较引用，直接修改源对象的值，引用值是不发生改变，React 无法检测到，就不会重新渲染，所以需要使用不可变对象（不直接改源对象，而是返回新对象）。即修改数组不能使用 push, splice 等等方法。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">      <span class="attr">arr</span>: [...<span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">arr</span>, 新值]</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure>

<h5 id="1-1-3-注意：state的更新是异步的"><a href="#1-1-3-注意：state的更新是异步的" class="headerlink" title="1.1.3 注意：state的更新是异步的"></a>1.1.3 注意：<code>state</code>的更新是异步的</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">changeC = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123; <span class="attr">count</span>: <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">count</span> + <span class="number">1</span> &#125;);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123; <span class="attr">count</span>: <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">count</span> + <span class="number">1</span> &#125;);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123; <span class="attr">count</span>: <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">count</span> + <span class="number">1</span> &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 这里的结果是只增加了 1，原因是： state 的更新可能是异步的，出与性能的考虑，React 会把多个 setState 的调用合并为一个调用；</span></span><br></pre></td></tr></table></figure>

<p>setState 方法通过一个队列机制实现 state 更新，当执行 setState 的时候，会将更新的 state 合并后放入队列，而不会立即更新。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">如果不想 setState 被合并，那么需要传递函数来实现：</span><br><span class="line"></span><br><span class="line">changeC = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(<span class="function">(<span class="params">preState</span>) =&gt;</span> (&#123;</span><br><span class="line">        <span class="attr">count</span>: preState.<span class="property">count</span> + <span class="number">1</span></span><br><span class="line">    &#125;))</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(<span class="function">(<span class="params">preState</span>) =&gt;</span> (&#123;</span><br><span class="line">        <span class="attr">count</span>: preState.<span class="property">count</span> + <span class="number">1</span></span><br><span class="line">    &#125;))</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(<span class="function">(<span class="params">preState</span>) =&gt;</span> (&#123;</span><br><span class="line">        <span class="attr">count</span>: preState.<span class="property">count</span> + <span class="number">1</span></span><br><span class="line">    &#125;))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="1-1-4-事件处理"><a href="#1-1-4-事件处理" class="headerlink" title="1.1.4 事件处理"></a>1.1.4 事件处理</h5><p>绑定事件：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">// 写法1：需要在构造函数中绑定 this</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">Counter</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 绑定函数 this 指向</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">changeCount</span> = <span class="variable language_">this</span>.<span class="property">changeCount</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">changeCount</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">onClick</span>=<span class="string">&#123;this.changeCount&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 写法2：在 render 中绑定 this </span></span><br><span class="line"><span class="comment">// 会存在一个问题：即每次视图更新，都会重新绑定</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">Counter</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">    <span class="title function_">changeCount</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">onClick</span>=<span class="string">&#123;this.changeCount.bind(this)&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 写法3：使用箭头函数</span></span><br><span class="line"><span class="comment">// 会存在一个问题：即每次视图更新，都会重新绑定</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">Counter</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">    <span class="title function_">changeCount</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> this.changeCount()&#125;&gt;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 写法4 - ES7写法（实验性质）</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">Counter</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">    changeCount = <span class="function">() =&gt;</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">onClick</span>=<span class="string">&#123;this.changeCount&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>参数传递：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 方式1</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">Counter</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">    <span class="title function_">changeCount</span>(<span class="params">str</span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">onClick</span>=<span class="string">&#123;this.changeCount.bind(this,</span> &#x27;<span class="attr">abc</span>&#x27;)&#125;&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 方式2</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">Counter</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">    <span class="title function_">changeCount</span>(<span class="params">str</span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> this.changeCount(&#x27;abc&#x27;)&#125;&gt;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 方式3 - 给标签自定义属性</span></span><br><span class="line">    &lt;button data-msg=<span class="string">&quot;hi&quot;</span> onClick=&#123;<span class="variable language_">this</span>.<span class="property">changeCount</span>&#125;&gt;&lt;/button&gt;</span><br><span class="line"></span><br><span class="line">changeCount = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="1-2-函数组件"><a href="#1-2-函数组件" class="headerlink" title="1.2 函数组件"></a>1.2 函数组件</h4><p>概述：函数组件接受一个参数，该参数是父组件传递的props，组件内部必须返回 React 元素。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> 组件名(props) &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> ()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>事件处理：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">onHandler</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;事件&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;onHandler&#125;</span>&gt;</span>按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>



<h3 id="2-组件通信"><a href="#2-组件通信" class="headerlink" title="2. 组件通信"></a>2. 组件通信</h3><h4 id="2-1-props"><a href="#2-1-props" class="headerlink" title="2.1 props"></a>2.1 props</h4><p>概述：父组件传递给子组件的数据，子组件不能修改该数据，在 <code>class </code>组件中通过 <code>this.props </code>的方式获取。</p>
<p>使用：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">// 子组件</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">Welcome</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">    <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#x27;welcome&#x27;</span>&gt;</span>&#123;this.props.msg&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 父组件</span></span><br><span class="line">    &lt;<span class="title class_">Welcome</span> msg=<span class="string">&quot;Hi Props&quot;</span> /&gt;</span><br></pre></td></tr></table></figure>

<p>peops约束：因为从 React 15.x 开始移除了 props 约束，所以需要安装第三方模块实现</p>
<p><code>nom i --save prop-types</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">PropTypes</span> <span class="keyword">from</span> <span class="string">&#x27;prop-types&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">Welcome</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">    <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#x27;welcome&#x27;</span>&gt;</span>&#123;this.props.msg&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">Welcome</span>.<span class="property">propTypes</span> = &#123;</span><br><span class="line">    <span class="attr">msg</span>: <span class="title class_">PropTypes</span>.<span class="property">string</span></span><br><span class="line">    <span class="attr">msg</span>: <span class="title class_">PropTypes</span>.<span class="property">string</span>.<span class="property">isRequired</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-2-子传父"><a href="#2-2-子传父" class="headerlink" title="2.2 子传父"></a>2.2 子传父</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 父组件 </span></span><br><span class="line">callback = <span class="function">(<span class="params">id</span>) =&gt;</span> &#123;&#125;</span><br><span class="line">    &lt;<span class="title class_">Button</span> callback=&#123;callback&#125;&gt;&lt;/<span class="title class_">Button</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 子组件 </span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">props</span>.<span class="title function_">callback</span>(<span class="string">&#x27;传递给父组件数据&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="2-3-context"><a href="#2-3-context" class="headerlink" title="2.3 context"></a>2.3 context</h4><p>概述：提供了一个无需为没曾组建手动添加 props ，就能在组件树中进行数据传递的方法。</p>
<p>使用：</p>
<ol>
<li>新建 <code>context</code>文件</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">MyContext</span> = <span class="title class_">React</span>.<span class="title function_">createContext</span>([]) <span class="comment">// 创建一个</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">MyContext</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>新建<code>Provider</code> 组件</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">MyContext</span> <span class="keyword">from</span> <span class="string">&#x27;./MyContext&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">Provider</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    <span class="attr">msg</span>: <span class="string">&#x27;hello&#x27;</span>,</span><br><span class="line">    <span class="attr">list</span>: [],</span><br><span class="line">  &#125;</span><br><span class="line">  changeMsg = <span class="function">(<span class="params">msg</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">      msg,</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  addList = <span class="function">(<span class="params">todo</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">      <span class="attr">list</span>: [...<span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">list</span>, todo],</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> value = &#123;</span><br><span class="line">      <span class="attr">msg</span>: <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">msg</span>,</span><br><span class="line">      <span class="attr">list</span>: <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">list</span>,</span><br><span class="line">      <span class="attr">changeMsg</span>: <span class="variable language_">this</span>.<span class="property">changeMsg</span>,</span><br><span class="line">      <span class="attr">addList</span>: <span class="variable language_">this</span>.<span class="property">addList</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">MyContext.Provider</span> <span class="attr">value</span>=<span class="string">&#123;value&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;this.props.children&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">MyContext.Provider</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>class 组件使用 value</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">MyContext</span>.<span class="property">Consumer</span>&gt;</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="function">(<span class="params">value</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;value.msg&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &lt;/<span class="title class_">MyContext</span>.<span class="property">Consumer</span>&gt;</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>函数组件使用</li>
</ol>
<p>概述： 允许在函数组件中使用 context 对象，在 context 值发生改变时重新渲染。</p>
<p>问题：context 的值发生改变，无论子组件是否引用 value， 都会导致 子组件重新渲染。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;useContext&#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line">   <span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">     <span class="keyword">const</span> context = <span class="title function_">useContext</span>(<span class="title class_">MyContext</span>); <span class="comment">// 需要接受context作为参数</span></span><br><span class="line"></span><br><span class="line">     <span class="keyword">return</span> (</span><br><span class="line">       <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;context.msg&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">     )</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-4-useReducer"><a href="#2-4-useReducer" class="headerlink" title="2.4 useReducer"></a>2.4 useReducer</h4><p>概述： useReducer 是 useState 的替代方案，能够解决 useState 状态更新逻辑散落在 UI 中，不能独立复用，不方便测试。</p>
<p>使用：</p>
<ol>
<li>新建<code>FnProvider</code>组件</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useState, useReducer &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">MyContext</span> <span class="keyword">from</span> <span class="string">&#x27;./MyContext&#x27;</span></span><br><span class="line"><span class="keyword">import</span> todoReducer <span class="keyword">from</span> <span class="string">&#x27;./todoReducer&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">FnProvider</span>(<span class="params">props</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [msg, changeMsg] = <span class="title function_">useState</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">  <span class="comment">//   const [todoList, setTodoList] = useState([])</span></span><br><span class="line">  <span class="keyword">const</span> [todoList, dispatch] = <span class="title function_">useReducer</span>(todoReducer, [])</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h2</span>&gt;</span>FnProvider<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">MyContext.Provider</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">value</span>=<span class="string">&#123;&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">msg</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">changeMsg</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">todoList</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">dispatch</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;props.children&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">MyContext.Provider</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>新建<code>reducer.js</code>文件</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">todoReducer</span>(<span class="params">state, action</span>) &#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.<span class="property">type</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;ADD&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> [...state, action.<span class="property">todo</span>]</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;DEL&#x27;</span>:</span><br><span class="line">      <span class="keyword">return</span> state.<span class="title function_">filter</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> item.<span class="property">id</span> !== action.<span class="property">id</span>)</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;EDIT&#x27;</span>:</span><br><span class="line">      <span class="keyword">const</span> index = state.<span class="title function_">findIndex</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> item.<span class="property">id</span> === action.<span class="property">payload</span>.<span class="property">id</span>) <span class="comment">// 返回下标</span></span><br><span class="line">      <span class="keyword">const</span> newTodoList = [...state]</span><br><span class="line">      newTodoList.<span class="title function_">splice</span>(index, <span class="number">1</span>, action.<span class="property">payload</span>.<span class="property">todo</span>)</span><br><span class="line">      <span class="keyword">return</span> newTodoList</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>调用</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">FnProvider</span> <span class="keyword">from</span> <span class="string">&#x27;./store/FnProvider&#x27;</span></span><br><span class="line"></span><br><span class="line">&lt;<span class="title class_">FnProvider</span>&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">HashRouter</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">App</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">HashRouter</span>&gt;</span></span></span><br><span class="line">  &lt;/<span class="title class_">FnProvider</span>&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useContext, useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> context = <span class="title function_">useContext</span>(<span class="title class_">MyContext</span>)</span><br><span class="line"></span><br><span class="line">onClick=&#123;<span class="function">() =&gt;</span></span><br><span class="line">          context.<span class="title function_">dispatch</span>(&#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="string">&#x27;DEL&#x27;</span>,</span><br><span class="line">            <span class="attr">id</span>: item.<span class="property">id</span>,</span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-5-redux"><a href="#2-5-redux" class="headerlink" title="2.5 redux"></a>2.5 redux</h4><p>概述：redux 是 JS 的状态容器，可以使用一个叫 action 对象的事件来管理和更新应用的状态。不依赖于任何的框架，可以在 JS 中独立使用。</p>
<h5 id="2-5-1-环境搭建"><a href="#2-5-1-环境搭建" class="headerlink" title="2.5.1 环境搭建"></a>2.5.1 环境搭建</h5><p>新项目：</p>
<p><code>npx create-react-app 项目名 --template redux</code></p>
<p><code>npx create-react-app 项目名 --template redux-typescript</code></p>
<p>老项目：</p>
<p><code>npm i redux react-redux</code></p>
<h5 id="2-5-2-项目引入"><a href="#2-5-2-项目引入" class="headerlink" title="2.5.2 项目引入"></a>2.5.2 项目引入</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Provider</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux&#x27;</span></span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;./store/index&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>));</span><br><span class="line">root.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">Provider</span> <span class="attr">store</span>=<span class="string">&#123;store&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">App</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">Provider</span>&gt;</span></span></span><br><span class="line">);</span><br><span class="line"><span class="title function_">reportWebVitals</span>();</span><br></pre></td></tr></table></figure>

<h5 id="2-5-3-store-创建"><a href="#2-5-3-store-创建" class="headerlink" title="2.5.3 store 创建"></a>2.5.3 store 创建</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createStore, combineReducers &#125; <span class="keyword">from</span> <span class="string">&#x27;redux&#x27;</span></span><br><span class="line"><span class="keyword">import</span> reducer <span class="keyword">from</span> <span class="string">&#x27;./reducer/reducer&#x27;</span></span><br><span class="line"><span class="keyword">import</span> todoReduce <span class="keyword">from</span> <span class="string">&#x27;./reducer/todoReducer&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> mainReducer = <span class="title function_">combineReducers</span>(&#123;</span><br><span class="line">  <span class="attr">reducer</span>: reducer,</span><br><span class="line">  <span class="attr">todo</span>: todoReduce,</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">createStore</span>(mainReducer)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 检测 state 的变化</span></span><br><span class="line">store.<span class="title function_">subscribe</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;数据发生改变&#x27;</span>, store.<span class="title function_">getState</span>())</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="2-5-4-reducer"><a href="#2-5-4-reducer" class="headerlink" title="2.5.4 reducer"></a>2.5.4 reducer</h5><p>概述：是一个纯函数，会根据不同的 action 对象返回一个新的 state</p>
<p>纯函数：</p>
<ul>
<li>不修改传入的参数</li>
<li>不执行有副作用的操作，比如API，计时器等等</li>
<li>不调用非纯函数，如<code>new Date()</code></li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> initData = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">id</span>: <span class="title class_">Date</span>.<span class="title function_">now</span>(),</span><br><span class="line">    <span class="attr">flag</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">text</span>: <span class="string">&#x27;练习篮球一年半&#x27;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> addActionType = <span class="string">&#x27;ADD&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">addTodo</span> = (<span class="params">payload</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">type</span>: addActionType,</span><br><span class="line">    payload,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> editActionType = <span class="string">&#x27;EDIT&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">editTodo</span> = (<span class="params">payload</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">type</span>: editActionType,</span><br><span class="line">    payload,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">DelType</span> = <span class="string">&#x27;DEL&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">actionDel</span> = (<span class="params">payload</span>) =&gt; (&#123;</span><br><span class="line">  <span class="attr">type</span>: <span class="title class_">DelType</span>,</span><br><span class="line">  payload,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">todoReduce</span>(<span class="params">state = initData, action</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; type, payload &#125; = action</span><br><span class="line">  <span class="keyword">switch</span> (type) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="attr">addActionType</span>:</span><br><span class="line">      <span class="keyword">return</span> [...state, payload]</span><br><span class="line">    <span class="keyword">case</span> <span class="title class_">DelType</span>:</span><br><span class="line">      <span class="keyword">return</span> state.<span class="title function_">filter</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> item.<span class="property">id</span> !== payload.<span class="property">id</span>)</span><br><span class="line">    <span class="keyword">case</span> <span class="attr">editActionType</span>:</span><br><span class="line">      <span class="keyword">const</span> index = state.<span class="title function_">findIndex</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> item.<span class="property">id</span> === payload.<span class="property">id</span>) <span class="comment">// 返回下标</span></span><br><span class="line">      <span class="keyword">const</span> newTodoList = [...state]</span><br><span class="line">      newTodoList.<span class="title function_">splice</span>(index, <span class="number">1</span>, payload)</span><br><span class="line">      <span class="keyword">return</span> newTodoList</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="2-5-5-combineReducers"><a href="#2-5-5-combineReducers" class="headerlink" title="2.5.5 combineReducers"></a>2.5.5 combineReducers</h5><p>概述：用于将多个 reducer 合并为一个 reducer。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;combineReducers&#125; <span class="keyword">from</span> <span class="string">&#x27;redux&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> mainReducer = <span class="title function_">combineReducers</span>(&#123;</span><br><span class="line">    home,</span><br><span class="line">    user,</span><br><span class="line">    todo</span><br><span class="line">&#125;)</span><br><span class="line">store = <span class="title function_">createStore</span>(mainReducer)</span><br></pre></td></tr></table></figure>

<h5 id="2-5-6-useSelector"><a href="#2-5-6-useSelector" class="headerlink" title="2.5.6 useSelector"></a>2.5.6 useSelector</h5><p>概述：用于组件中获取 state 的hook</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;useSelector&#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> const App =() =&gt; &#123;</span></span><br><span class="line"><span class="string">    const todoList = useSelector((state) =&gt; state.todo)</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>

<h5 id="2-5-7-useDispatch"><a href="#2-5-7-useDispatch" class="headerlink" title="2.5.7 useDispatch"></a>2.5.7 useDispatch</h5><p>概述：返回 dispatch 函数的引用</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;useDispatch&#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">const App =() =&gt; &#123;</span></span><br><span class="line"><span class="string">    const dispatch = useDispatch()</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    const onSubmitTodo = () =&gt; &#123;</span></span><br><span class="line"><span class="string">    dispatch(</span></span><br><span class="line"><span class="string">      addTodo(&#123;</span></span><br><span class="line"><span class="string">        text,</span></span><br><span class="line"><span class="string">        id: Date.now(),</span></span><br><span class="line"><span class="string">        flag: false,</span></span><br><span class="line"><span class="string">      &#125;)</span></span><br><span class="line"><span class="string">    )</span></span><br><span class="line"><span class="string">    setText(&#x27;</span><span class="string">&#x27;)</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>

<h5 id="2-5-8-redux-thunk"><a href="#2-5-8-redux-thunk" class="headerlink" title="2.5.8 redux-thunk"></a>2.5.8 redux-thunk</h5><p>概述： 因为在 reducer 中只能同步操作，那么要想异步处理 redux 就只能在组件中先进行异步操作，然后成功后再 dispatch。但是会让redux 的逻辑散落在UI中，不易于后期管理。</p>
<p>接用该插件可以实现 dispatch 一个函数，然后在这个函数中处理异步。</p>
<p><code>index.js</code> 文件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createStore, applyMiddleware, compose &#125; <span class="keyword">from</span> <span class="string">&#x27;redux&#x27;</span></span><br><span class="line"><span class="keyword">import</span> thunkMiddleware <span class="keyword">from</span> <span class="string">&#x27;redux-thunk&#x27;</span></span><br><span class="line"><span class="keyword">import</span> logger <span class="keyword">from</span> <span class="string">&#x27;redux-logger&#x27;</span></span><br><span class="line"><span class="keyword">import</span> mainReducer <span class="keyword">from</span> <span class="string">&#x27;./reducer&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> middleWares = [</span><br><span class="line">  <span class="comment">// 三方模块通过该中间件注册</span></span><br><span class="line">  thunkMiddleware,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (process.<span class="property">env</span>.<span class="property">NODE_ENV</span> === <span class="string">&#x27;development&#x27;</span>) &#123;</span><br><span class="line">  middleWares.<span class="title function_">push</span>(logger)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Redux DevTools 配置</span></span><br><span class="line"><span class="keyword">const</span> composeEnhancers = <span class="variable language_">window</span>.<span class="property">__REDUX_DEVTOOLS_EXTENSION_COMPOSE__</span> || compose</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建 store</span></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">createStore</span>(</span><br><span class="line">  mainReducer,</span><br><span class="line">  <span class="title function_">composeEnhancers</span>(<span class="title function_">applyMiddleware</span>(...middleWares))</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 检测redux 的状态变化</span></span><br><span class="line">store.<span class="title function_">subscribe</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;数据发生改变&#x27;</span>, store.<span class="title function_">getState</span>())</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>userAction.js</code>文件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="variable constant_">LOGIN</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;../actionTypes/userActionType&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; loginApi &#125; <span class="keyword">from</span> <span class="string">&#x27;../../http/Api/user&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 同步 类似于 Vuex-mutation</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">loginAction</span> = (<span class="params">payload</span>) =&gt; (&#123;</span><br><span class="line">  <span class="attr">type</span>: <span class="variable constant_">LOGIN</span>,</span><br><span class="line">  payload,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">loginActionAsync</span> = (<span class="params">payload</span>) =&gt; <span class="function">(<span class="params">dispatch</span>) =&gt;</span></span><br><span class="line">  <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">loginApi</span>(payload).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (res.<span class="property">data</span>.<span class="property">code</span> == <span class="string">&#x27;200&#x27;</span>) &#123;</span><br><span class="line">        <span class="title function_">dispatch</span>(<span class="title function_">loginAction</span>(res.<span class="property">data</span>.<span class="property">data</span>))</span><br><span class="line">        <span class="title function_">resolve</span>()</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;登陆失败&#x27;</span>)</span><br><span class="line">        <span class="title function_">reject</span>()</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>userReducer.js</code>文件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="variable constant_">LOGIN</span>, <span class="variable constant_">LOGOUT</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;../actionTypes/userActionType&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">INIT_STATE</span> = &#123;</span><br><span class="line">  <span class="attr">userId</span>: <span class="literal">null</span>,</span><br><span class="line">  <span class="attr">username</span>: <span class="literal">null</span>,</span><br><span class="line">  <span class="attr">authList</span>: [],</span><br><span class="line">  <span class="attr">token</span>: <span class="literal">null</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">userReducer</span>(<span class="params">state = INIT_STATE, action</span>) &#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.<span class="property">type</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="attr">LOGIN</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        ...state,</span><br><span class="line">        ...action.<span class="property">payload</span>,</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">case</span> <span class="attr">LOGOUT</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">userId</span>: <span class="literal">null</span>,</span><br><span class="line">        <span class="attr">username</span>: <span class="literal">null</span>,</span><br><span class="line">        <span class="attr">authList</span>: [],</span><br><span class="line">        <span class="attr">token</span>: <span class="literal">null</span>,</span><br><span class="line">      &#125;                      </span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>reducer/index.js</code>文件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; combineReducers &#125; <span class="keyword">from</span> <span class="string">&#x27;redux&#x27;</span></span><br><span class="line"><span class="keyword">import</span> userReducer <span class="keyword">from</span> <span class="string">&#x27;./userReducer&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">combineReducers</span>(&#123;</span><br><span class="line">  <span class="attr">user</span>: userReducer,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>使用：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; loginAction, loginActionAsync &#125; <span class="keyword">from</span> <span class="string">&#x27;../../store/actions/userAction&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useDispatch &#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">Login</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> navigate = <span class="title function_">useNavigate</span>()</span><br><span class="line">  <span class="keyword">const</span> dispatch = <span class="title function_">useDispatch</span>()</span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">onFinish</span> = <span class="keyword">async</span> (<span class="params">value</span>) =&gt; &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(value)</span><br><span class="line">    <span class="title function_">dispatch</span>(<span class="title function_">loginActionAsync</span>(value)).<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">navigate</span>(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">return</span> ()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-6-PubSubJs"><a href="#2-6-PubSubJs" class="headerlink" title="2.6  PubSubJs"></a>2.6  PubSubJs</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 引入</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">PubSub</span> <span class="keyword">from</span> <span class="string">&#x27;pubsub-js&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 订阅消息</span></span><br><span class="line"><span class="title class_">PubSub</span>.<span class="title function_">subscribe</span>(<span class="string">&quot;getSate&quot;</span>,<span class="function">(<span class="params">_,data</span>)=&gt;</span>&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(data)</span><br><span class="line">        &#125;)</span><br><span class="line"><span class="title class_">PubSub</span>.<span class="title function_">subscribe</span>(<span class="string">&quot;订阅的消息名称&quot;</span>,回调函数，第一个参数是消息名称，可以使用_来占位，第二个是传递的数据</span><br><span class="line">        &#125;)</span><br><span class="line">        </span><br><span class="line"><span class="comment">// 发布消息</span></span><br><span class="line"><span class="title class_">PubSub</span>.<span class="title function_">publish</span>(<span class="string">&quot;getSate&quot;</span>,&#123;<span class="attr">isFrist</span>:<span class="literal">false</span>,<span class="attr">isLoad</span>:<span class="literal">true</span>&#125;)</span><br><span class="line"><span class="title class_">PubSub</span>.<span class="title function_">publish</span>(<span class="string">&quot;订阅的消息名称&quot;</span>,传递的数据)</span><br></pre></td></tr></table></figure>

<h4 id="2-7-RTK"><a href="#2-7-RTK" class="headerlink" title="2.7 RTK"></a>2.7 RTK</h4><h3 id="3-class-生命周期"><a href="#3-class-生命周期" class="headerlink" title="3. class 生命周期"></a>3. class 生命周期</h3><p>过时的生命周期：</p>
<table>
<thead>
<tr>
<th align="center">名称</th>
<th align="center">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code>componentWillMount</code></td>
<td align="center">卸载组件之后</td>
</tr>
<tr>
<td align="center"><code>componentWillReceiveProps</code></td>
<td align="center">父组件进行了更新，子组件先执行这个【注意，第一次传递数据的时候，并不执行】</td>
</tr>
<tr>
<td align="center"><code>componentWillUpdate</code></td>
<td align="center">组件将要更新之前</td>
</tr>
</tbody></table>
<p>原因： 这些生命周期方法经常被误解和滥用；此外，我们预计，在异步渲染中，它们潜在的误用问题可能更大。 </p>
<p>现存生命周期：</p>
<table>
<thead>
<tr>
<th align="center">名称</th>
<th align="center">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code>constructor</code></td>
<td align="center">加载的时候调用一次，初始化state</td>
</tr>
<tr>
<td align="center"><code>render</code></td>
<td align="center">更新 DOM 树的，每次渲染都会重新调用</td>
</tr>
<tr>
<td align="center"><code>componentDidMount</code></td>
<td align="center">组件渲染之后调用一次，一般在这个阶段发起请求、操作 DOM 节点</td>
</tr>
<tr>
<td align="center"><code>shouldComponentUpdate</code></td>
<td align="center">组件接收到新的 props 或者 state 的时候调用，该函数内返回 true 则渲染组件，返回 False 就不渲染</td>
</tr>
<tr>
<td align="center"><code>componentDidUpdate</code></td>
<td align="center">组件更新后，可以获取最新的 state</td>
</tr>
<tr>
<td align="center"><code>componentWillUnmount</code></td>
<td align="center">组件卸载，需要清除计时器、事件绑定 等</td>
</tr>
</tbody></table>
<h3 id="4-插槽"><a href="#4-插槽" class="headerlink" title="4. 插槽"></a>4. 插槽</h3><h4 id="4-1-匿名插槽"><a href="#4-1-匿名插槽" class="headerlink" title="4.1 匿名插槽"></a>4.1 匿名插槽</h4><p>概述：写在每个组件之间的内容都可以被 props.children 获取。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 父组件 </span></span><br><span class="line">&lt;<span class="title class_">TodoButton</span>&gt;新增&lt;/<span class="title class_">TodoButton</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 子组件</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;this.props.children&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">    )</span><br></pre></td></tr></table></figure>

<h4 id="4-2-具名插槽"><a href="#4-2-具名插槽" class="headerlink" title="4.2 具名插槽"></a>4.2 具名插槽</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 父组件 </span></span><br><span class="line">&lt;<span class="title class_">TodoList</span> right=&#123;<span class="language-xml"><span class="tag">&lt;<span class="name">TodoButton</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">TodoButton</span>&gt;</span></span>&#125;&gt;&lt;/<span class="title class_">TodoList</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 子组件</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;this.props.right&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<h4 id="4-3-作用域插槽"><a href="#4-3-作用域插槽" class="headerlink" title="4.3 作用域插槽"></a>4.3 作用域插槽</h4><p>概述：允许给子组件传递自定义内容，同时父组件也能拿到子组件的数据。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 父组件 </span></span><br><span class="line"> &lt;<span class="title class_">TodoList</span></span><br><span class="line">   data=&#123;todoList&#125;</span><br><span class="line">   right=&#123;<span class="function">(<span class="params">item</span>) =&gt;</span> <span class="language-xml"><span class="tag">&lt;<span class="name">TodoButton</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> this.delTodo(item.id)&#125;&gt;删除<span class="tag">&lt;/<span class="name">TodoButton</span>&gt;</span></span>&#125;&gt;</span><br><span class="line"> &lt;/<span class="title class_">TodoList</span>&gt;</span><br><span class="line"></span><br><span class="line"> <span class="comment">// 子组件</span></span><br><span class="line"> <span class="keyword">const</span> lis = data.<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">   <span class="keyword">return</span> (</span><br><span class="line">     <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#x27;todo-item&#x27;</span> <span class="attr">key</span>=<span class="string">&#123;item.id&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">       <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#x27;todo-item-text&#x27;</span>&gt;</span>&#123;item.text&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">       <span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;this.props.right &amp;&amp; this.props.right(item)&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">   )</span><br><span class="line"> &#125;)</span><br></pre></td></tr></table></figure>

<h3 id="5-hooks"><a href="#5-hooks" class="headerlink" title="5. hooks"></a>5. hooks</h3><p>概述：可以让你在不编写 class 的情况下使用 state 以及其他的 React 特性。</p>
<p>注意：</p>
<ul>
<li>只能在函数顶层调用hooks</li>
<li>不能写在循环、条件判断中</li>
<li>只能是在函数组件中或者自定义hook函数中</li>
</ul>
<h4 id="5-1-useState"><a href="#5-1-useState" class="headerlink" title="5.1 useState"></a>5.1 useState</h4><p>概述：该方法用于定义函数组件的 state 的。 </p>
<p>语法：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;useState&#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> [state, setState] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line">      <span class="keyword">const</span> [msg, setMsg] = <span class="title function_">useState</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h4 id="5-2-useEffect"><a href="#5-2-useEffect" class="headerlink" title="5.2 useEffect"></a>5.2 useEffect</h4><p>概述：该函数可以看做是函数组件的生命周期，包含 <code>componentDidMount</code>，<code>componentDidUpdate</code>，<code>componentWillUnmount</code>，在render 之后执行。</p>
<p>语法：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;useEffect&#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="title function_">useEffect</span>(callback, [dependencies])</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">useLayoutEffect会在渲染的内容更新到<span class="variable constant_">DOM</span>上之前进行,会阻塞<span class="variable constant_">DOM</span>的更新</span><br><span class="line">如果我们希望在某些操作发生之后再更新<span class="variable constant_">DOM</span>,那么应该将这个操作放在useLayoutEffect</span><br></pre></td></tr></table></figure>

<p><code>dependencies</code>：该参数是 <code>useEffect</code>的依赖，可以决定 <code>useEffect</code> 的<code>callback </code>什么时候执行。</p>
<ul>
<li><p>如果该参数不存在，则初始化、组件任意状态值改变都会导致 callback 执行</p>
</li>
<li><p>如果该参数传递一个 []，只有组件初始化和销毁的时候才会触发 callback</p>
</li>
<li><p>该参数传入 [a]。表示在依赖 a 发生变化时才会触发 callback</p>
</li>
<li><pre><code class="js">useEffect(() =&gt; &#123;
      console.log(&#39;Counter&#39;);
    &#125;, [count]);
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">`callback`：回调函数，一般用于发起请求、添加计时器、事件绑定，在该函数中可以return 一个函数，这个函数作为下一次 callback 执行前的调用，用于清除上一次 callback 产生的副作用。</span><br><span class="line"></span><br><span class="line">```js</span><br><span class="line"> useEffect(() =&gt; &#123;</span><br><span class="line">     console.log(&#x27;Counter&#x27;); // 组件加载的时候执行</span><br><span class="line"></span><br><span class="line">     return () =&gt; &#123;</span><br><span class="line">         // 组件卸载的时候执行</span><br><span class="line">         console.log(&#x27;useEffect 回调函数的返回值函数&#x27;);</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;, []);</span><br><span class="line"></span><br><span class="line">// 没有设置依赖</span><br><span class="line">useEffect(() =&gt; &#123;</span><br><span class="line">      console.log(&#x27;Counter&#x27;);</span><br><span class="line">      const timer = setInterval(() =&gt; console.log(Date.now()), 1000)</span><br><span class="line"></span><br><span class="line">      return () =&gt; &#123;</span><br><span class="line">        console.log(&#x27;useEffect 回调函数的返回值函数&#x27;);</span><br><span class="line"></span><br><span class="line">        // 组件卸载之后需要干掉计时器</span><br><span class="line">        clearInterval(timer)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
</ul>
<h4 id="5-3-useRef"><a href="#5-3-useRef" class="headerlink" title="5.3 useRef"></a>5.3 useRef</h4><p>概述：与<code>createRef</code>类似，用于获取 dom 元素或者组件实例</p>
<p>语法：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;useRef&#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> myRef = <span class="title function_">useRef</span>();</span><br><span class="line"></span><br><span class="line">    <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(myRef.<span class="property">current</span>); <span class="comment">// 需要通过 current 获取节点</span></span><br><span class="line">    &#125;, [])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">ref</span>=<span class="string">&#123;myRef&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="5-n-自定义hooks"><a href="#5-n-自定义hooks" class="headerlink" title="5.n 自定义hooks"></a>5.n 自定义hooks</h4><h5 id="1-封装useTableList"><a href="#1-封装useTableList" class="headerlink" title="1. 封装useTableList"></a>1. 封装useTableList</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment">listReq:api请求</span></span><br><span class="line"><span class="comment">option:obj</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">    cur:当前页数</span></span><br><span class="line"><span class="comment">    size:一页多少条数据</span></span><br><span class="line"><span class="comment">    data:查询参数</span></span><br><span class="line"><span class="comment">    flag:是否自动请求</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">useList</span>(<span class="params">listReq, option</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> [list, setList] = <span class="title function_">useState</span>([])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> flag = option?.<span class="property">flag</span> || <span class="literal">true</span> <span class="comment">// 默认自动请求</span></span><br><span class="line">    <span class="keyword">const</span> cur = option?.<span class="property">cur</span> || <span class="number">1</span></span><br><span class="line">    <span class="keyword">const</span> size = option?.<span class="property">size</span> || <span class="number">5</span></span><br><span class="line">    <span class="keyword">const</span> data = option?.<span class="property">data</span> || &#123;&#125;</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">getList</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">        <span class="keyword">const</span> payload = &#123; ...data, <span class="attr">current</span>: cur, <span class="attr">pageSize</span>: size &#125;</span><br><span class="line">        <span class="title function_">listReq</span>(payload)</span><br><span class="line">            .<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span><br><span class="line">            <span class="keyword">if</span> (res.<span class="property">code</span> == <span class="string">&#x27;200&#x27;</span>) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(res.<span class="property">data</span>)</span><br><span class="line">                <span class="comment">//   setList(res.)</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;获取数据错误&#x27;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">            .<span class="title function_">catch</span>(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(err)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    flag &amp;&amp; <span class="title function_">getList</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        list,</span><br><span class="line">        getList,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="2-封装useLocalStorage"><a href="#2-封装useLocalStorage" class="headerlink" title="2. 封装useLocalStorage"></a>2. 封装useLocalStorage</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">useSessionStorage</span>(<span class="params">key</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [state, setState] = <span class="title function_">useState</span>(<span class="function">() =&gt;</span> <span class="title function_">getStorage</span>())</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">getStorage</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> value = <span class="variable language_">sessionStorage</span>.<span class="title function_">getItem</span>(key)</span><br><span class="line">    <span class="keyword">if</span> (value) &#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title class_">JSON</span>.<span class="title function_">parse</span>(value)</span><br><span class="line">      &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(error)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">undefined</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">updateState</span> = (<span class="params">newState</span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">// 如果为undefined 则删除该键</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> newState == <span class="string">&#x27;undefined&#x27;</span>) &#123;</span><br><span class="line">      <span class="variable language_">sessionStorage</span>.<span class="title function_">removeItem</span>(key)</span><br><span class="line">      <span class="title function_">setState</span>(<span class="literal">undefined</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="variable language_">sessionStorage</span>.<span class="title function_">setItem</span>(key, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(newState))</span><br><span class="line">      <span class="title function_">setState</span>(newState)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123; state, updateState &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="6-重要属性"><a href="#6-重要属性" class="headerlink" title="6. 重要属性"></a>6. 重要属性</h3><h4 id="6-1-ref"><a href="#6-1-ref" class="headerlink" title="6.1 ref"></a>6.1 ref</h4><p>概述：用于获取DOM节点</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> ... &#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">super</span>()</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">myRef</span> = <span class="title class_">React</span>.<span class="title function_">createRef</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">componentDidMount</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// 必须通过 current 获取节点</span></span><br><span class="line">        <span class="comment">// 即 this.myRef.current 表示 dom ，相当于 document.getElementById()</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">myRef</span>.<span class="property">current</span>.<span class="title function_">focus</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">ref</span>=<span class="string">&#123;this.myRef&#125;</span> /&gt;</span></span></span><br><span class="line">)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="6-2-fragment"><a href="#6-2-fragment" class="headerlink" title="6.2 fragment"></a>6.2 fragment</h4><p>默认情况下 <code>react</code> 的render 只支持单标签渲染，如果想要渲染多标签，那么可以使用该组件，可以再不多增加标签嵌套的情况下，渲染节点。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">React</span>.<span class="property">Fragment</span>&gt;</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/<span class="title class_">React</span>.<span class="property">Fragment</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 简写</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/&gt;</span></span></span><br></pre></td></tr></table></figure>

<h4 id="6-3-portal"><a href="#6-3-portal" class="headerlink" title="6.3 portal"></a>6.3 portal</h4><p>概述：期望渲染的节点能够脱离父组件范围，可以将节点放在任意我期望的位置。</p>
<p>语法：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">craetePortal</span>(child, container)</span><br><span class="line"></span><br><span class="line">      * child：任何有效的节点或者 <span class="title class_">React</span> 组件；</span><br><span class="line">      * container：希望将 child 放在什么位置，应该是一个 <span class="variable constant_">DOM</span> 节点；</span><br></pre></td></tr></table></figure>

<h4 id="6-4-createElement"><a href="#6-4-createElement" class="headerlink" title="6.4 createElement"></a>6.4 createElement</h4><p>概述：因为 JSX 语法中的元素底层就是调用该方法生成组件的。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> myDiv = <span class="title class_">React</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>, <span class="literal">null</span>, <span class="string">&#x27;标签之间的哦内容&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">myDiv</span> /&gt;</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="7-高阶组件-HOC"><a href="#7-高阶组件-HOC" class="headerlink" title="7. 高阶组件(HOC)"></a>7. 高阶组件(HOC)</h3><p>概述：以组件为参数，返回新组件的函数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">WithTable</span> = (<span class="params">Component</span>) =&gt; &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">// props = &#123;loading: false, titile: &#x27;&#x27;&#125; = &#123;loading, ...otherProps&#125;</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">NewComponent</span> = (<span class="params">&#123; loading, ...otherProps &#125;</span>) =&gt; &#123;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;HOC 的 props：&#x27;</span>, otherProps);</span><br><span class="line"><span class="keyword">if</span> (loading) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>loading...<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">Component</span> &#123;<span class="attr">...otherProps</span>&#125; /&gt;</span></span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建一个新组件</span></span><br><span class="line"><span class="comment">// const Loading = () =&gt; &lt;div&gt;loading...&lt;/div&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="title class_">NewComponent</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">WithTable</span></span><br></pre></td></tr></table></figure>

<h3 id="8-性能优化"><a href="#8-性能优化" class="headerlink" title="8. 性能优化"></a>8. 性能优化</h3><p>父子组件嵌套：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 执行顺序</span></span><br><span class="line">    <span class="title class_">Father</span> render - </span><br><span class="line">    <span class="title class_">ClassA</span>.<span class="property">jsx</span>:<span class="number">14</span> <span class="title class_">ClassA</span> constructor</span><br><span class="line">    <span class="title class_">ClassA</span>.<span class="property">jsx</span>:<span class="number">23</span> <span class="title class_">ClassA</span> render</span><br><span class="line">    <span class="title class_">ClassA</span>.<span class="property">jsx</span>:<span class="number">17</span> <span class="title class_">ClassA</span> componentDidMount</span><br><span class="line">    <span class="title class_">Father</span> useEffect -</span><br></pre></td></tr></table></figure>

<p>子组件数据改变后：</p>
<ul>
<li><p>子组件 render;</p>
</li>
<li><p>父组件不变</p>
</li>
</ul>
<p>父组件状态改变：</p>
<ul>
<li>父组件 render</li>
<li>子组件无论与父组件的状态是否有关，都会render</li>
</ul>
<h4 id="8-1-class-组件优化"><a href="#8-1-class-组件优化" class="headerlink" title="8.1 class 组件优化"></a>8.1 class 组件优化</h4><h5 id="8-1-1-shouldComponentUpdate"><a href="#8-1-1-shouldComponentUpdate" class="headerlink" title="8.1.1 shouldComponentUpdate"></a>8.1.1 shouldComponentUpdate</h5><p>概述：针对 class 组件，如果 props 和 state 都没有改变</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">shouldComponentUpdate</span>(<span class="params">nextProps, nextState</span>) &#123;</span><br><span class="line">      <span class="comment">// 该生命周期必须返回一个布尔值，如果为 true，则render，否则不render</span></span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ClassA shouldComponentUpdate&#x27;</span>, nextProps, nextState)</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">num2</span> != nextProps.<span class="property">num2</span> || <span class="variable language_">this</span>.<span class="property">state</span> != nextState) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h5 id="8-1-2-PureComponent"><a href="#8-1-2-PureComponent" class="headerlink" title="8.1.2 PureComponent"></a>8.1.2 PureComponent</h5><p>概述：React.PureComponent 和 React.Component用法差不多，唯一不同的是 PureComponent 会浅比较 props 和 state 是否相同，从而决定是否重新渲染组件。</p>
<h4 id="8-2-函数组件优化"><a href="#8-2-函数组件优化" class="headerlink" title="8.2 函数组件优化"></a>8.2 函数组件优化</h4><h5 id="8-2-1-useMemo"><a href="#8-2-1-useMemo" class="headerlink" title="8.2.1 useMemo"></a>8.2.1 useMemo</h5><p>概述：这个函数的返回值会被缓存，在组建第一次渲染的时候执行，以后会在以来发生改变后在此次执行。缓存数据</p>
<p>语法：<code>useMemo(create.deps)</code></p>
<ul>
<li>create：是一个函数，函数的返回值作为缓存值</li>
<li>deps：依赖，是一个数组</li>
</ul>
<p>作用：一般用于比较复杂的运算或者耗时操作</p>
<h5 id="8-2-2-useCallback"><a href="#8-2-2-useCallback" class="headerlink" title="8.2.2 useCallback"></a>8.2.2 useCallback</h5><p>概述：useCallback 和 useMemo 接受参数一样，都是依赖发生改变后执行回调，否则返回缓存值，区别是 useCallback 是返回函数， useMemo 是返回运算结果。缓存函数</p>
<h4 id="8-3-memo-优化"><a href="#8-3-memo-优化" class="headerlink" title="8.3 memo 优化"></a>8.3 memo 优化</h4><p>概述：和 PureComponent 类似，用于性能调优，函数组件和类组件都可以使用，区别是 memo 只能判断 props 而不能处理 state 的改变。</p>
<p>语法：<code>memo(组件)</code></p>
<h3 id="9-路由"><a href="#9-路由" class="headerlink" title="9. 路由"></a>9. 路由</h3><p><code>npm install react-router-dom</code></p>
<h4 id="9-1-Route"><a href="#9-1-Route" class="headerlink" title="9.1 Route"></a>9.1 Route</h4><p>概述：用于匹配当前 url 要渲染的组件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">Route</span> path=<span class="string">&quot;url&quot;</span> element=&#123;&lt;组件 /&gt;&#125; /&gt;</span><br></pre></td></tr></table></figure>

<p>index：表示默认路由，设置该属性后，Route 不能有子组件</p>
<h4 id="9-2-Routes"><a href="#9-2-Routes" class="headerlink" title="9.2 Routes"></a>9.2 Routes</h4><p>概述：作为 Route 的上一级组件，可以优化路径匹配</p>
<h4 id="9-3-Link"><a href="#9-3-Link" class="headerlink" title="9.3 Link"></a>9.3 Link</h4><p>用于连接跳转，最终会被渲染为a 标签</p>
<p><code>to</code>：链接的路径</p>
<p><code>&#123;pathname:&#39;/admin&#39;,query:&#39;111&#39;,state:&#39;111&#39;&#125;</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 通过this.props.location.state或this.props.location.query来获取即可</span></span><br></pre></td></tr></table></figure>

<h4 id="9-4-路由嵌套"><a href="#9-4-路由嵌套" class="headerlink" title="9.4 路由嵌套"></a>9.4 路由嵌套</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">Route</span> path=<span class="string">&quot;/&quot;</span> element=&#123;<span class="language-xml"><span class="tag">&lt;<span class="name">Layout</span> /&gt;</span></span>&#125;&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Route</span> <span class="attr">index</span> <span class="attr">element</span>=<span class="string">&#123;</span>&lt;<span class="attr">Home</span> /&gt;</span>&#125; /&gt;</span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;about&quot;</span> <span class="attr">element</span>=<span class="string">&#123;</span>&lt;<span class="attr">About</span> /&gt;</span>&#125; /&gt;</span></span><br><span class="line">  &lt;/<span class="title class_">Route</span>&gt;</span><br><span class="line"></span><br><span class="line">在父组件中使用 &lt;<span class="title class_">Outlet</span> /&gt; 渲染子组件</span><br><span class="line">  <span class="comment">// Layout </span></span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Outlet</span> /&gt;</span></span></span><br><span class="line">  &lt;/div&gt;</span><br></pre></td></tr></table></figure>

<h4 id="9-5-useNavigate"><a href="#9-5-useNavigate" class="headerlink" title="9.5 useNavigate"></a>9.5 <code>useNavigate</code></h4><p>概述：用于返回一个类似 history 的对象，可用于编程式导航。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useNavigate &#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> navigate = <span class="title function_">useNavigate</span>();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 传递 url 参数</span></span><br><span class="line">  <span class="title function_">navigate</span>(<span class="string">&#x27;/home&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 传递数字来表示前进或者后退多少</span></span><br><span class="line">  <span class="title function_">navigate</span>(-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 替换历史记录</span></span><br><span class="line">  <span class="title function_">navigate</span>(<span class="string">&#x27;/&#x27;</span>, &#123;<span class="attr">replace</span>: <span class="literal">true</span>&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="9-6-useSearchParams"><a href="#9-6-useSearchParams" class="headerlink" title="9.6 useSearchParams "></a>9.6 <code>useSearchParams </code></h4><p>概述：获取 url 的查询参数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useSearchParams &#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [searchParams, setSearchParams] = <span class="title function_">useSearchParams</span>()</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;获取查询参数：&#x27;</span>, searchParams.<span class="title function_">get</span>(<span class="string">&#x27;id&#x27;</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">//  this.props.location.search也可以获取</span></span><br></pre></td></tr></table></figure>

<h4 id="9-7-useParams"><a href="#9-7-useParams" class="headerlink" title="9.7 useParams"></a>9.7 <code>useParams</code></h4><p>概述：获取动态参数<code>path=&#39;/admin/:id&#39;</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useParams &#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> params = <span class="title function_">useParams</span>();</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;获取动态参数：&#x27;</span>, params);</span><br><span class="line"></span><br><span class="line"><span class="comment">// this.props.match.params.id也可以获取</span></span><br></pre></td></tr></table></figure>

<h4 id="9-8-路由模式"><a href="#9-8-路由模式" class="headerlink" title="9.8 路由模式"></a>9.8 路由模式</h4><h5 id="1-hasn模式"><a href="#1-hasn模式" class="headerlink" title="1. hasn模式"></a>1. hasn模式</h5><ul>
<li><code>hash</code> 模式是一种把前端路由的路径用井号 <code>#</code> 拼接在真实 <code>url</code> 后面的模式。当井号 <code>#</code> 后面的路径发生变化时，浏览器并不会重新发起请求，而是会触发 <code>onhashchange</code> 事件。不会被包括在 <code>http</code> 请求中。</li>
<li>hash变化会触发网页跳转，即浏览器的前进和后退。</li>
<li><code>hash</code> 通过 <code>window.onhashchange</code> 的方式，来监听 <code>hash</code> 的改变，借此实现无刷新跳转的功能</li>
<li><code>hash</code> 可以改变 <code>url</code> ，但是不会触发页面重新加载，不会出现在&#96;&#96;http&#96;中</li>
<li>首先，<code>hash</code>本来是拿来做页面定位的，如果拿来做路由的话，原来的锚点功能就不能用了。其次，&#96;&#96;hash<code>的传参是基于</code>url&#96;的，如果要传递复杂的数据，会有体积的限制</li>
</ul>
<h5 id="2-history模式"><a href="#2-history模式" class="headerlink" title="2. history模式"></a>2. history模式</h5><ul>
<li>利用H5的 history中新增的两个API <code>pushState()</code> 和 <code>replaceState()</code> 和一个事件&#96;&#96;onpopstate&#96;监听URL变化</li>
<li><code>history</code>每次刷新会重新像后端请求整个网址，也就是重新请求服务器。如果后端没有及时响应，就会报错404！ </li>
<li><code>history</code>模式不仅可以在&#96;&#96;url&#96;里放参数，还可以将数据存放在一个特定的对象中。</li>
<li>修改历史状态：  包括了 HTML5 History Interface 中新增的 <code>pushState()</code> 和 <code>replaceState()</code> 方法，这两个方法应用于浏览器的历史记录栈，提供了对历史记录进行修改的功能。只是当他们进行修改时，虽然修改了 url，但浏览器不会立即向后端发送请求。如果要做到改变 url 但又不刷新页面的效果，就需要前端用上这两个 API。 </li>
<li>切换历史状态： 包括 <code>forward()</code>、<code>back()</code>、<code>go()</code> 三个方法，对应浏览器的前进，后退，跳转操作。</li>
</ul>
<h5 id="3-两种模式对比"><a href="#3-两种模式对比" class="headerlink" title="3. 两种模式对比"></a>3. 两种模式对比</h5><ul>
<li>history 模式的 pushState() 设置的新 URL 可以是与当前 URL 同源的任意 URL；而 hash 只可修改 # 后面的部分，因此只能设置与当前 URL 同文档的 URL；</li>
<li>pushState() 设置的新 URL 可以与当前 URL 一模一样，这样也会把记录添加到栈中；而 hash 设置的新值必须与原来不一样才会触发动作将记录添加到栈中；</li>
<li>pushState() 通过 stateObject 参数可以添加任意类型的数据到记录中；而 hash 只可添加短字符串；</li>
<li>pushState() 可额外设置 title 属性供后续使用。</li>
<li>hash 模式下，仅 hash 符号之前的 url 会被包含在请求中，后端如果没有做到对路由的全覆盖，也不会返回 404 错误；history 模式下，前端的 url 必须和实际向后端发起请求的 url一致，如果没有对用的路由处理，将返回 404 错误。</li>
</ul>
<h3 id="10-事件处理"><a href="#10-事件处理" class="headerlink" title="10. 事件处理"></a>10. 事件处理</h3><ul>
<li>React的事件是通过onXxx属性指定事件处理函数 </li>
<li>React使用的都是自定义的时间，而不是原生的事件 </li>
<li>React中的事件是通过事件委托方式处理的 </li>
<li>通过event.target得到发生事件的Dom元素对象 </li>
<li>事件中必须返回的是函数</li>
</ul>
<h4 id="10-1-受控和非受控组件"><a href="#10-1-受控和非受控组件" class="headerlink" title="10.1 受控和非受控组件"></a>10.1 受控和非受控组件</h4><p>受控： 对于受控组件来说，输入的值始终由 React 的 state 驱动。 </p>
<p>非受控： 表单元素的值不会更新state。输入数据都是现用现取的。 </p>
<h4 id="10-2-class-事件处理"><a href="#10-2-class-事件处理" class="headerlink" title="10.2 class 事件处理"></a>10.2 class 事件处理</h4><p>绑定事件：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">// 写法1：需要在构造函数中绑定 this</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">Counter</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 绑定函数 this 指向</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">changeCount</span> = <span class="variable language_">this</span>.<span class="property">changeCount</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">changeCount</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">onClick</span>=<span class="string">&#123;this.changeCount&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 写法2：在 render 中绑定 this </span></span><br><span class="line"><span class="comment">// 会存在一个问题：即每次视图更新，都会重新绑定</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">Counter</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">    <span class="title function_">changeCount</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">onClick</span>=<span class="string">&#123;this.changeCount.bind(this)&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 写法3：使用箭头函数</span></span><br><span class="line"><span class="comment">// 会存在一个问题：即每次视图更新，都会重新绑定</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">Counter</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">    <span class="title function_">changeCount</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> this.changeCount()&#125;&gt;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 写法4 - ES7写法（实验性质）</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">Counter</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">    changeCount = <span class="function">() =&gt;</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">onClick</span>=<span class="string">&#123;this.changeCount&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>参数传递：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 方式1</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">Counter</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">    <span class="title function_">changeCount</span>(<span class="params">str</span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">onClick</span>=<span class="string">&#123;this.changeCount.bind(this,</span> &#x27;<span class="attr">abc</span>&#x27;)&#125;&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 方式2</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">Counter</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">    <span class="title function_">changeCount</span>(<span class="params">str</span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> this.changeCount(&#x27;abc&#x27;)&#125;&gt;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 方式3 - 给标签自定义属性</span></span><br><span class="line">    &lt;button data-msg=<span class="string">&quot;hi&quot;</span> onClick=&#123;<span class="variable language_">this</span>.<span class="property">changeCount</span>&#125;&gt;&lt;/button&gt;</span><br><span class="line"></span><br><span class="line">changeCount = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="10-3-函数组件事件处理"><a href="#10-3-函数组件事件处理" class="headerlink" title="10.3 函数组件事件处理"></a>10.3 函数组件事件处理</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">onHandler</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;事件&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;onHandler&#125;</span>&gt;</span>按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<h3 id="11-Diff算法"><a href="#11-Diff算法" class="headerlink" title="11. Diff算法"></a>11. Diff算法</h3><h4 id="11-1-index"><a href="#11-1-index" class="headerlink" title="11.1 index"></a>11.1 index</h4><p>问题：</p>
<ul>
<li><p>若对数据进行:逆序添加、逆序删除等破坏顺序操作:</p>
<p> 会产生没有必要的真实DOM更新 界面效果没问题,但效率低。</p>
</li>
<li><p>如果结构中还包含输入类的DOM:会产生错误DOM更新 界面有问题。</p>
</li>
<li><p>注意! 如果不存在对数据的逆序添加、逆序删除等破坏顺序操作，仅用于渲染列表用于展示，使用index作为key是没有问题的。</p>
</li>
</ul>
<h4 id="11-2-diff"><a href="#11-2-diff" class="headerlink" title="11.2 diff"></a>11.2 diff</h4><p>Diff算法其实就是react生成的新虚拟DOM和以前的旧虚拟DOM的比较规则：</p>
<ul>
<li>如果旧的虚拟DOM中找到了与新虚拟DOM相同的key:<ul>
<li>如果内容没有变化，就直接只用之前旧的真实DOM</li>
<li>如果内容发生了变化，就生成新的真实DOM</li>
</ul>
</li>
<li>如果旧的虚拟DOM中没有找到了与新虚拟DOM相同的key:<ul>
<li>根据数据创建新的真实的DOM,随后渲染到页面上</li>
</ul>
</li>
</ul>
<h2 id="二、React-周边"><a href="#二、React-周边" class="headerlink" title="二、React 周边"></a>二、React 周边</h2><h3 id="1-css处理"><a href="#1-css处理" class="headerlink" title="1. css处理"></a>1. css处理</h3><h4 id="1-1-局部-css-样式"><a href="#1-1-局部-css-样式" class="headerlink" title="1.1 局部 css 样式"></a>1.1 局部 css 样式</h4><ol>
<li><p>要求新建：文件名.module.css</p>
<ol>
<li>在该文家中创建css代码</li>
</ol>
<p>			</p>
</li>
<li><p>导入样式：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> styles <span class="keyword">from</span> <span class="string">&#x27;文件名.module.css&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">className</span>=<span class="string">&#123;styles.btn_default&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="1-2-引入sass"><a href="#1-2-引入sass" class="headerlink" title="1.2 引入sass"></a>1.2 引入sass</h4><p>概述：只需要在当前环境中安装以下模块就可以直接使用。</p>
<p><code>npm i sass</code></p>
<h3 id="2-antd-引入"><a href="#2-antd-引入" class="headerlink" title="2. antd 引入"></a>2. antd 引入</h3><p><code>npm i antd</code></p>
<p>配置模块安装：</p>
<p><code>npm i @craco/craco -D --legacy-peer-deps</code></p>
<p><code>npm i babel-plugin-import -D</code></p>
<p>修改package.json 里的 scripts</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;script&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;start&quot;</span>: <span class="string">&quot;craco start&quot;</span></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>根目录下创建配置文件 craco.config.js 文件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="attr">babel</span>: &#123;</span><br><span class="line">      <span class="attr">plugins</span>: [</span><br><span class="line">        [<span class="string">&quot;import&quot;</span>, &#123;</span><br><span class="line">          <span class="attr">libraryName</span>: <span class="string">&#x27;antd&#x27;</span>,</span><br><span class="line">          <span class="attr">libraryDirectory</span>: <span class="string">&#x27;es&#x27;</span>,</span><br><span class="line">          <span class="attr">style</span>: <span class="string">&#x27;css&#x27;</span></span><br><span class="line">        &#125;]</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">webpack</span>: &#123;</span><br><span class="line">      <span class="attr">alias</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;@&#x27;</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&#x27;src&#x27;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://793335974.github.io/79333">菜</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://793335974.github.io/79333/2021/08/10/React%E7%AC%94%E8%AE%B0/">https://793335974.github.io/79333/2021/08/10/React%E7%AC%94%E8%AE%B0/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://793335974.github.io/79333" target="_blank">野菜收留所</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/79333/tags/%E7%BC%96%E7%A8%8B/">编程</a><a class="post-meta__tags" href="/79333/tags/%E5%89%8D%E7%AB%AF/">前端</a><a class="post-meta__tags" href="/79333/tags/React/">React</a><a class="post-meta__tags" href="/79333/tags/%E6%A1%86%E6%9E%B6/">框架</a></div><div class="post_share"><div class="social-share" data-image="https://api.gumengya.com/Api/FjImg?format=image&amp;_t=18" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://npm.elemecdn.com/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://npm.elemecdn.com/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/79333/2021/08/11/ajax%E5%92%8Caxios%E7%AC%94%E8%AE%B0/" title="AJAX和Axios笔记"><img class="cover" src="https://api.gumengya.com/Api/FjImg?format=image&amp;_t=7" onerror="onerror=null;src='/79333/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">AJAX和Axios笔记</div></div></a></div><div class="next-post pull-right"><a href="/79333/2021/05/24/TS%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B/" title="TS快速上手"><img class="cover" src="https://api.gumengya.com/Api/FjImg?format=image&amp;_t=20" onerror="onerror=null;src='/79333/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">TS快速上手</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/79333/2021/01/11/CSS%E7%AC%94%E8%AE%B0/" title="CSS笔记"><img class="cover" src="https://api.gumengya.com/Api/FjImg?format=image&_t=10" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-01-11</div><div class="title">CSS笔记</div></div></a></div><div><a href="/79333/2021/01/11/Canvas%E7%AC%94%E8%AE%B0/" title="Canvas笔记"><img class="cover" src="https://api.gumengya.com/Api/FjImg?format=image&_t=9" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-01-11</div><div class="title">Canvas笔记</div></div></a></div><div><a href="/79333/2021/04/15/Git%E7%AC%94%E8%AE%B0/" title="Git笔记"><img class="cover" src="https://api.gumengya.com/Api/FjImg?format=image&_t=11" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-04-15</div><div class="title">Git笔记</div></div></a></div><div><a href="/79333/2021/11/21/HTML%E7%AC%94%E8%AE%B0/" title="HTML笔记"><img class="cover" src="https://api.gumengya.com/Api/FjImg?format=image&_t=13" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-11-21</div><div class="title">HTML笔记</div></div></a></div><div><a href="/79333/2021/01/18/Mysql%E7%AC%94%E8%AE%B0/" title="Mysql笔记"><img class="cover" src="https://api.gumengya.com/Api/FjImg?format=image&_t=16" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-01-18</div><div class="title">Mysql笔记</div></div></a></div><div><a href="/79333/2021/01/11/JS%E7%AC%94%E8%AE%B0/" title="JS笔记"><img class="cover" src="https://api.gumengya.com/Api/FjImg?format=image&_t=15" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-01-11</div><div class="title">JS笔记</div></div></a></div><div><a href="/79333/2021/01/11/Node.js%E7%AC%94%E8%AE%B0/" title="Node.js笔记"><img class="cover" src="https://api.gumengya.com/Api/FjImg?format=image&_t=17" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-01-11</div><div class="title">Node.js笔记</div></div></a></div><div><a href="/79333/2021/05/24/TS%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B/" title="TS快速上手"><img class="cover" src="https://api.gumengya.com/Api/FjImg?format=image&_t=20" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-05-24</div><div class="title">TS快速上手</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/79333/img/avatar.jpg" onerror="this.onerror=null;this.src='/79333/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">菜</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/79333/archives/"><div class="headline">文章</div><div class="length-num">21</div></a><a href="/79333/tags/"><div class="headline">标签</div><div class="length-num">25</div></a><a href="/79333/categories/"><div class="headline">分类</div><div class="length-num">14</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">太难了！！！</div></div><div class="card-widget"><div class="item-headline"><i></i><span></span></div><div class="item-content"><div class="container-width"><video class="videoPlayer" width="100%" controls loop  muted src="//api.yujn.cn/api/zzxjj.php"></video><div class="button-container"><button onclick="togglePlayPause()">播放/暂停</button><button onclick="playNextVideo()">下一个视频</button></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81React%E7%AE%80%E4%BB%8B"><span class="toc-text">一、React简介</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-React%E5%85%A5%E9%97%A8"><span class="toc-text">1. React入门</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-React%E9%A1%B9%E7%9B%AE%E5%88%9B%E5%BB%BA"><span class="toc-text">2. React项目创建</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-%E5%AE%98%E6%96%B9%E8%84%9A%E6%89%8B%E6%9E%B6"><span class="toc-text">2.1 官方脚手架</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-vite"><span class="toc-text">2.2 vite</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-redux"><span class="toc-text">2.3 redux</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-redux-thunk"><span class="toc-text">2.4 redux-thunk</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-index-html"><span class="toc-text">2.5 index.html</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-6-%E8%B7%AF%E7%94%B1"><span class="toc-text">2.6 路由</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-JSX%E8%AF%AD%E6%B3%95"><span class="toc-text">3. JSX语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E8%B7%A8%E5%9F%9F"><span class="toc-text">4. 跨域</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%B8%80%EF%BC%9Aproxy"><span class="toc-text">方法一：proxy</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E4%BA%8C%EF%BC%9A%E5%88%9B%E5%BB%BA%E4%BB%A3%E7%90%86%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-text">方法二：创建代理配置文件</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-React-%E5%92%8C-Vue%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-text">5. React 和 Vue的区别</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81React%E6%A0%B8%E5%BF%83"><span class="toc-text">二、React核心</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E7%BB%84%E4%BB%B6%E5%8C%96"><span class="toc-text">1. 组件化</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-class-%E7%BB%84%E4%BB%B6"><span class="toc-text">1.1 class 组件</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%89%A7%E8%A1%8C%E8%BF%87%E7%A8%8B"><span class="toc-text">执行过程</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-1-1-%E8%AF%AD%E6%B3%95"><span class="toc-text">1.1.1 语法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-1-2-%E4%BF%AE%E6%94%B9%E6%95%B0%E6%8D%AE"><span class="toc-text">1.1.2 修改数据</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-1-3-%E6%B3%A8%E6%84%8F%EF%BC%9Astate%E7%9A%84%E6%9B%B4%E6%96%B0%E6%98%AF%E5%BC%82%E6%AD%A5%E7%9A%84"><span class="toc-text">1.1.3 注意：state的更新是异步的</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-1-4-%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86"><span class="toc-text">1.1.4 事件处理</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-%E5%87%BD%E6%95%B0%E7%BB%84%E4%BB%B6"><span class="toc-text">1.2 函数组件</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E7%BB%84%E4%BB%B6%E9%80%9A%E4%BF%A1"><span class="toc-text">2. 组件通信</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-props"><span class="toc-text">2.1 props</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-%E5%AD%90%E4%BC%A0%E7%88%B6"><span class="toc-text">2.2 子传父</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-context"><span class="toc-text">2.3 context</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-useReducer"><span class="toc-text">2.4 useReducer</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-redux"><span class="toc-text">2.5 redux</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#2-5-1-%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA"><span class="toc-text">2.5.1 环境搭建</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-5-2-%E9%A1%B9%E7%9B%AE%E5%BC%95%E5%85%A5"><span class="toc-text">2.5.2 项目引入</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-5-3-store-%E5%88%9B%E5%BB%BA"><span class="toc-text">2.5.3 store 创建</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-5-4-reducer"><span class="toc-text">2.5.4 reducer</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-5-5-combineReducers"><span class="toc-text">2.5.5 combineReducers</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-5-6-useSelector"><span class="toc-text">2.5.6 useSelector</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-5-7-useDispatch"><span class="toc-text">2.5.7 useDispatch</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-5-8-redux-thunk"><span class="toc-text">2.5.8 redux-thunk</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-6-PubSubJs"><span class="toc-text">2.6  PubSubJs</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-7-RTK"><span class="toc-text">2.7 RTK</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-class-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-text">3. class 生命周期</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E6%8F%92%E6%A7%BD"><span class="toc-text">4. 插槽</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-%E5%8C%BF%E5%90%8D%E6%8F%92%E6%A7%BD"><span class="toc-text">4.1 匿名插槽</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-%E5%85%B7%E5%90%8D%E6%8F%92%E6%A7%BD"><span class="toc-text">4.2 具名插槽</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-%E4%BD%9C%E7%94%A8%E5%9F%9F%E6%8F%92%E6%A7%BD"><span class="toc-text">4.3 作用域插槽</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-hooks"><span class="toc-text">5. hooks</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-1-useState"><span class="toc-text">5.1 useState</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-2-useEffect"><span class="toc-text">5.2 useEffect</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-3-useRef"><span class="toc-text">5.3 useRef</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-n-%E8%87%AA%E5%AE%9A%E4%B9%89hooks"><span class="toc-text">5.n 自定义hooks</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E5%B0%81%E8%A3%85useTableList"><span class="toc-text">1. 封装useTableList</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E5%B0%81%E8%A3%85useLocalStorage"><span class="toc-text">2. 封装useLocalStorage</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E9%87%8D%E8%A6%81%E5%B1%9E%E6%80%A7"><span class="toc-text">6. 重要属性</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#6-1-ref"><span class="toc-text">6.1 ref</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-2-fragment"><span class="toc-text">6.2 fragment</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-3-portal"><span class="toc-text">6.3 portal</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-4-createElement"><span class="toc-text">6.4 createElement</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E9%AB%98%E9%98%B6%E7%BB%84%E4%BB%B6-HOC"><span class="toc-text">7. 高阶组件(HOC)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96"><span class="toc-text">8. 性能优化</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#8-1-class-%E7%BB%84%E4%BB%B6%E4%BC%98%E5%8C%96"><span class="toc-text">8.1 class 组件优化</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#8-1-1-shouldComponentUpdate"><span class="toc-text">8.1.1 shouldComponentUpdate</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#8-1-2-PureComponent"><span class="toc-text">8.1.2 PureComponent</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-2-%E5%87%BD%E6%95%B0%E7%BB%84%E4%BB%B6%E4%BC%98%E5%8C%96"><span class="toc-text">8.2 函数组件优化</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#8-2-1-useMemo"><span class="toc-text">8.2.1 useMemo</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#8-2-2-useCallback"><span class="toc-text">8.2.2 useCallback</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-3-memo-%E4%BC%98%E5%8C%96"><span class="toc-text">8.3 memo 优化</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-%E8%B7%AF%E7%94%B1"><span class="toc-text">9. 路由</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#9-1-Route"><span class="toc-text">9.1 Route</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-2-Routes"><span class="toc-text">9.2 Routes</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-3-Link"><span class="toc-text">9.3 Link</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-4-%E8%B7%AF%E7%94%B1%E5%B5%8C%E5%A5%97"><span class="toc-text">9.4 路由嵌套</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-5-useNavigate"><span class="toc-text">9.5 useNavigate</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-6-useSearchParams"><span class="toc-text">9.6 useSearchParams </span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-7-useParams"><span class="toc-text">9.7 useParams</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-8-%E8%B7%AF%E7%94%B1%E6%A8%A1%E5%BC%8F"><span class="toc-text">9.8 路由模式</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-hasn%E6%A8%A1%E5%BC%8F"><span class="toc-text">1. hasn模式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-history%E6%A8%A1%E5%BC%8F"><span class="toc-text">2. history模式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-%E4%B8%A4%E7%A7%8D%E6%A8%A1%E5%BC%8F%E5%AF%B9%E6%AF%94"><span class="toc-text">3. 两种模式对比</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86"><span class="toc-text">10. 事件处理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#10-1-%E5%8F%97%E6%8E%A7%E5%92%8C%E9%9D%9E%E5%8F%97%E6%8E%A7%E7%BB%84%E4%BB%B6"><span class="toc-text">10.1 受控和非受控组件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-2-class-%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86"><span class="toc-text">10.2 class 事件处理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-3-%E5%87%BD%E6%95%B0%E7%BB%84%E4%BB%B6%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86"><span class="toc-text">10.3 函数组件事件处理</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-Diff%E7%AE%97%E6%B3%95"><span class="toc-text">11. Diff算法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#11-1-index"><span class="toc-text">11.1 index</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#11-2-diff"><span class="toc-text">11.2 diff</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81React-%E5%91%A8%E8%BE%B9"><span class="toc-text">二、React 周边</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-css%E5%A4%84%E7%90%86"><span class="toc-text">1. css处理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-%E5%B1%80%E9%83%A8-css-%E6%A0%B7%E5%BC%8F"><span class="toc-text">1.1 局部 css 样式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-%E5%BC%95%E5%85%A5sass"><span class="toc-text">1.2 引入sass</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-antd-%E5%BC%95%E5%85%A5"><span class="toc-text">2. antd 引入</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/79333/2024/05/03/vue%E6%8C%87%E4%BB%A4/" title="vue指令命令"><img src="https://api.gumengya.com/Api/FjImg?format=image&amp;_t=2" onerror="this.onerror=null;this.src='/79333/img/404.jpg'" alt="vue指令命令"/></a><div class="content"><a class="title" href="/79333/2024/05/03/vue%E6%8C%87%E4%BB%A4/" title="vue指令命令">vue指令命令</a><time datetime="2024-05-03T03:46:10.854Z" title="发表于 2024-05-03 11:46:10">2024-05-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/79333/2024/04/12/600%E4%B8%AA%E8%8B%B1%E8%AF%AD%E5%9B%9B%E7%BA%A7%E5%8D%95%E8%AF%8D/" title="英语四级单词"><img src="https://api.gumengya.com/Api/FjImg?format=image&amp;_t=1" onerror="this.onerror=null;this.src='/79333/img/404.jpg'" alt="英语四级单词"/></a><div class="content"><a class="title" href="/79333/2024/04/12/600%E4%B8%AA%E8%8B%B1%E8%AF%AD%E5%9B%9B%E7%BA%A7%E5%8D%95%E8%AF%8D/" title="英语四级单词">英语四级单词</a><time datetime="2024-04-12T07:28:25.000Z" title="发表于 2024-04-12 15:28:25">2024-04-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/79333/2024/04/12/%E7%94%9F%E6%B4%BB%E5%B8%B8%E7%94%A8%E8%8B%B1%E8%AF%AD%E5%8D%95%E8%AF%8D/" title="生活常用英语单词"><img src="https://api.gumengya.com/Api/FjImg?format=image&amp;_t=5" onerror="this.onerror=null;this.src='/79333/img/404.jpg'" alt="生活常用英语单词"/></a><div class="content"><a class="title" href="/79333/2024/04/12/%E7%94%9F%E6%B4%BB%E5%B8%B8%E7%94%A8%E8%8B%B1%E8%AF%AD%E5%8D%95%E8%AF%8D/" title="生活常用英语单词">生活常用英语单词</a><time datetime="2024-04-12T02:46:56.000Z" title="发表于 2024-04-12 10:46:56">2024-04-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/79333/2024/04/09/this%E6%8C%87%E5%90%91%E9%97%AE%E9%A2%98/" title="this指向问题"><img src="https://api.gumengya.com/Api/FjImg?format=image&amp;_t=19" onerror="this.onerror=null;this.src='/79333/img/404.jpg'" alt="this指向问题"/></a><div class="content"><a class="title" href="/79333/2024/04/09/this%E6%8C%87%E5%90%91%E9%97%AE%E9%A2%98/" title="this指向问题">this指向问题</a><time datetime="2024-04-09T11:54:26.000Z" title="发表于 2024-04-09 19:54:26">2024-04-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/79333/2024/03/24/bulid%20bk/" title="bk"><img src="https://api.gumengya.com/Api/FjImg?format=image&amp;_t=8" onerror="this.onerror=null;this.src='/79333/img/404.jpg'" alt="bk"/></a><div class="content"><a class="title" href="/79333/2024/03/24/bulid%20bk/" title="bk">bk</a><time datetime="2024-03-24T03:41:33.000Z" title="发表于 2024-03-24 11:41:33">2024-03-24</time></div></div></div></div></div></div></main><footer id="footer" style="background: radial-gradient(circle, rgba(238,174,202,1) 0%, rgba(148,187,233,0.9884746134782038) 100%);"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By 菜</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/79333/js/utils.js"></script><script src="/79333/js/main.js"></script><script src="/79333/pluginsSrc/@fancyapps/ui/dist/fancybox/fancybox.umd.js?v=5.0.33"></script><script src="https://npm.elemecdn.com/instant.page/instantpage.js" type="module"></script><script src="https://npm.elemecdn.com/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://npm.elemecdn.com/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><div class="js-pjax"></div><div class="aplayer no-destroy" data-id="9812808059" data-server="netease" data-type="playlist" data-fixed="true" data-autoplay="false" data-lrctype="1"> </div><script src="https://npm.elemecdn.com/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-show-text" src="/79333/pluginsSrc/butterfly-extsrc/dist/click-show-text.min.js?v=1.1.3" data-mobile="true" data-text="你好,富强,民主,文明,和谐,自由,平等,公正,法治,敬业,诚信,友善" data-fontsize="15px" data-random="true" async="async"></script><link rel="stylesheet" href="https://npm.elemecdn.com/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://npm.elemecdn.com/aplayer/dist/APlayer.min.js"></script><script src="https://npm.elemecdn.com/ethan4116-blog/lib/js/theme/meting.min.js"></script><script src="https://npm.elemecdn.com/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"]):not([href="/music/"]):not([href="/no-pjax/"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener
  btf.removeGlobalFnEvent('pjax')
  btf.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/79333/404.html')
  }
})</script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/79333/js/search/local-search.js"></script></div></div></body></html>